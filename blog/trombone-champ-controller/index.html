<!doctype html>
<html lang="en">
  <head>
    <link rel="shortcut icon" type="image/png" href="../../assets/img/favicon.png" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta
      property="og:title"
      content="Sick Doots: Playing Trombone
Champ with a slide whistle"
    />
    <meta property="og:description" content="TODO" />
    <meta property="og:url" content="https://www.hannahilea.com/blog/trombone-champ-controller" />
    <meta property="og:image" content="https://www.hannahilea.com/blog/trombone-champ-controller/assets/thumbnail.png" />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:image:width" content="300" />
    <meta property="og:image:height" content="300" />
    <meta property="og:type" content="website" />

    <title>Sick Doots: Playing Trombone Champ with a slide whistle</title>
    <link rel="stylesheet" type="text/css" href="../../assets/css/main.css" />
  </head>

  <body>
    <div class="main-container blog">
      <nav class="navbar" role="navigation">
        @hannahilea:
        <a class="nav-link" href="../..">home</a> | <a class="nav-link" href="../../projects">projects</a> |
        <a class="nav-link" href="..">blog</a>
      </nav>
      <h1>Sick Doots: Playing Trombone Champ with a slide whistle</h1>
      <p>Are you familiar with the video game <a href="TODO">Trombone Champ</a>? If not, I am delighted be your first introduction to the best cursed game since the <a href="TODO">Untitled Goose Game</a>:</p>
      <p>TODO-video of TC</p>
      <p>
        When I first saw TC, my initial thought was HELL. YEAH. When I first played it, I realized that cool as it was, using a mouse (or trackpad) to control the trombone was just not putting me in the zone‚ÄîI really needed to physically
        embody a trombone god, or at least, what I imagined how being such a god would feel.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>
      </p>
      <p>
        How, I wondered, could I easily and cheaply‚Äîin both dollars and time‚Äîreplicate the physical slide motion in order to play this game? I found a few other folks online who‚Äôd made 3D printed trombone champ controllers that looked like
        tiny trombones, but those didn‚Äôt quite suit my needs. Enter: the humble slide whistle.
      </p>
      <p>
        After drawing <a href="TODO">the rest of the fucking owl</a>, I give you my entry in the Trombone Champ controller pantheon: wireless,<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> easy to
        replicate, and delightfully slide-y:
      </p>
      <p>TODO-pic of mine</p>
      <p>
        It‚Äôs worth noting that this is one of those projects that I started, didn‚Äôt touch for a year, and then picked up to finish recently‚Äîand in that time, Trombone Champ has released a Nintendo Switch variant and announced a pending
        virtual reality variant, both of which provide slidier control options for game play. At time of writing, I‚Äôve seen controllers that are <a href="TODO">3D printed</a> and <a href="TODO">made from real trombones</a>. Cool! There can
        be no such thing as too much Trombone Champ.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>
      </p>
      <h2 id="design">Design</h2>
      <p>My basic design goals: 1. Relatively cheap, easy to build (for me) a. Corollary: Relatively cheap, easy to replicate by anyone else 2. Playable in/by a crowd, i.e., easy to share with a friend without sharing viruses</p>
      <p>
        Starting from a (cheap!) slide whistle allowed me to sidestep designing and fabricating a controller body, plus was in the TC spirit of not taking itself too seriously.<a
          href="#fn4"
          class="footnote-ref"
          id="fnref4"
          role="doc-noteref"
          ><sup>4</sup></a
        >
        After perusing the <a href="TODO">vast and lovely Adafruit tutorials</a> I decided to use an Adafruit Feather Express as my microcontroller, as it natively supports Bluetooth and there are a lot of existing well-documented projects
        built on it‚Äîand more importantly, built in Python/CircuitPython, which met the ‚Äúeasy to build (for me)‚Äù criteria on the software side.
      </p>
      <p>
        On to sensor selection. I needed at least two inputs: a continuously varying 2-dimensional input to map to the y-axis (up/down) controll of the original mouse input, and a binary on/off input to map to the
        mouse-or-keyboard-button-push that triggers sound production in the game.
      </p>
      <p>
        The continuous sensor choice was relatively straight-forward: I picked out a couple lengths of slide potentiometer from Adafruit, with the plan of attaching the component to the slide whistle‚Äôs body and coupling the slider knob to
        the slide‚Äôs whistle. I had a few backup plans if that didn‚Äôt work, but luckily the longer of the potentiometers was perfect.
      </p>
      <p>
        The binary sensor choice was a bit more constrained. What would be REALLY nifty is if it was breath-controlled, and I considered using a cheap microphone and writing a noise gate for the input. However, goal 2 presented a bit of a
        reality check: I know from my early days learning flute just how gross it is to swap instruments around a group of people, and how annoying it is to have to clean the lip plate of a flute‚Äôs head joint off with rubbing alcohol before
        passing it to someone else to play, and I would <em>never</em> hand my sax to someone else to play unless they swapped in their own mouthpiece and/or reed, and I couldn‚Äôt picture a sanitary way of setting up a microphone on the
        slide whistle‚Äôs mouthpiece in a way that would be both playable and would discourage putting one‚Äôs mouth directly on/around the mouthpiece. SO. That was out.
      </p>
      <p>
        There are of course other ways to measure breath, but (also in the spirit of goal 2) it didn‚Äôt feel particularly easy or swappable to have to hook a user up to a physical respiration monitor of any sort. Perhaps as a future
        improvement! For now, I decided to go with a basic button. Alas!
      </p>
      <p>
        The button I originally ordered didn‚Äôt feel trivially clicky enough‚Äîit took too much finger movement to trigger it. Luckily we had a few other buttons lying around the house, so I picked the one that required the least amount of
        motion and strength to trigger. Using a button for this sensor is‚Ä¶fine? I don‚Äôt love it, but it is perfectly serviceable. I do think something more breath-based would be nicer, though, and I think it‚Äôs the weakest part of this
        controller, spiritually. :)
      </p>
      <h2 id="hardware-assembly">Hardware assembly</h2>
      <p>
        So back where design goal 1 specified ‚Äúeasy (for me)‚Äù, I cheated a bit: I am still getting my sea legs around electronics design and implementation, so knew that ‚Äújust‚Äù assembling everything would NOT actually easy for me, but I
        included ‚Äúeasy to ask for assistance‚Äù under the ‚Äúeasy‚Äù umbrella. Which is to say Alex Ferguson is responsible for creating/designing this section of the project!
      </p>
      <p>We (she) first stuck all our components in a breadboard and got the sensors hooked up to the Feather (microcontroller).</p>
      <p>The resultant circuit looks like this:</p>
      <p>TODO-circuit diagram</p>
      <p>
        I then did the software implementation described in the following section to make sure that I was able to convert the sensor input to Bluetooth ‚Äúmouse‚Äù output. Once we were satisfied with the behavior, we (Alex) attached the Feather
        and components to the slide whistle with a fun combination of hot glue, embroidery thread, and gluetack (to keep the flat backs of e.g.¬†the potentiometer stable on the round body of the whistle), and then did the requisite soldering
        between those components.
      </p>
      <p>
        Disclaimer on her behalf: Alex wanted to make a much more professional, beautifully wired version of this controller, but I was adamant that because it was a quasi-hacky prototype, string and electrical tape and visible disorganized
        wires were totally par for the course, and if it looks messy? It‚Äôs because it is, and that‚Äôs okay. She was eventually swayed, but clearly still has some Feelings‚Ñ¢ about it. :D
      </p>
      <h2 id="software">Software</h2>
      <p>
        I used <a href="TODO">this</a> tutorial as a starting point for writing CircuitPython that would map the sensor inputs to mouse outputs, and then send those via Bluetooth. Luckily there are nice CircuitPython libraries for both
        Bluetooth and HID (TODO) interactions, which made this fairly simple.
      </p>
      <p>The pseudocode for the run loop is something like this:</p>
      <pre><code># Setup 
slide_potentiometer = connect_to_analog_pin(1)
button = connect_to_digital_pin(2)
hid = setup_mouse_controller()

def map_voltage_to_screen_min_max(): 
    ...

# run loop 
while True:
    y_previous = 0
    button_is_pressed = False
    
    ...try to connect to bluetooth...

    while bluetooth_connected():
        # Handle slide behavior
        slide_voltage = slide_potentiometer.get_voltage()
        y_now = map_voltage_to_screen_min_max(slide_voltage)

        # The library expects a *relative* mouse movement, not an absolute one
        hid.send_mouse_y_update(y_previous - y_now)
        y_previous = y_now

        # Handle click behavior 
        button_state = button.get_value() # Returns true/false 
        if button_state != button_is_pressed:
            if button_state:
                hid.send_mouse_left_button_down()
            else:
                hid.send_mouse_left_button_up()
            button_is_pressed = button_state
</code></pre>
      <p>There‚Äôs some extra stuff in there where I disable sending commands from the controller if the reset button onboard the Feather has been pressed, but otherwise, other than some additonal setup, it‚Äôs basically that!</p>
      <p>
        The full script is <a href="TODO">here</a>. I‚Äôm new to organization of this type of microcontroller project, and still looking for ways to do it nicely‚Äîespecially for future larger-scoped projects‚Äîso if you have feelings about good
        practices in this space, please let me know.
      </p>
      <p>
        The hardest part of the software implementation was something I didn‚Äôt end up needing to write at all: because of how we‚Äôd put the Feather in the breadboard, our connection between the input pins and the sensors was tenuous at best,
        which lead to a voltage jump in the potentiometer while the button was pressed. At the time we didn‚Äôt realize that the cause was the breadboard/Feather connection, so I thought I was going to have to program around it, and spent a
        fair amount of time thinking about how I might do that (definitely doable, just an annoying exercise in bookkeeping!). Then as soon as we soldered everything together we discovered that the jump was gone, and figured out that the
        breadboard connection had been tenuous. Huzzah!
      </p>
      <h2 id="all-together-now">All together now!</h2>
      <p>
        Once the controller was set up, connecting it to play Trombone Champ was trivially easy: 1. From computer, look for (and connect to) bluetooth device ‚ÄúTrombone Champ Controller‚Äù 2. Open TC via Steam 3. ‚Ä¶that‚Äôs it. If you move the
        slide back and forth, the mouse goes up and down on the screen. (Of course, you don‚Äôt need to have TC open for the controller to function‚Äîyou can also, e.g., scroll a website that way. Did we do this? Absolutely. :joy:)
      </p>
      <ul>
        <li>It‚Äôs fun. :D And super goofy. And tbh, it isn‚Äôt that much harder than working with the mouse</li>
        <li>Immediately discovered a shorting issue on the button, fixed with electrical tape</li>
        <li>
          Hard to play! Our brass player (trumpet, so button-based) picked it up much more quickly than either I or our other flute-playing friend did
          <ul>
            <li>Smaller range of motion than a trombone slide AND more discrete positions required than a trombone</li>
          </ul>
        </li>
        <li>Have to reset the controller to map to the y-range of the screen; might be annoying if switching screens, as it is, a pain to first set the trombone slide to its lowest position and THEN set the bottom of the screen‚Ä¶.</li>
      </ul>
      <p>TODO-video of ppl playing it??</p>
      <h2 id="discussion">Discussion</h2>
      <p>
        This was a relatively easy and painless project, all things considered‚ÄîI chalk that up to a relatively small scope of the task and the existence of Adafruit tutorials.<a
          href="#fn5"
          class="footnote-ref"
          id="fnref5"
          role="doc-noteref"
          ><sup>5</sup></a
        >
        I thought it was going to be a much bigger lift, but once I realized that I could ‚Äújust‚Äù treat the controller as a mouse input, everything fell into place nicely.
      </p>
      <p>
        One side benefit of this particular project is that now that I know how we built <em>this</em> Bluetooth HID via CircuitPython and external sensors, I‚Äôve been able to pattern-map onto other projects, and basically handle the
        electronics and hardware pieces by myself. I‚Äôm learning! :D It feels good.
      </p>
      <p>
        In terms of next steps: - I could build a slightly nicer-packaged version of the whistle+electronics‚Äîbut I probably won‚Äôt! :D - I want to make some nice settings for automatically handling the slide-position-to-screen-mapping, since
        doing it manually each time the player changes is annoying - It would be cool to build a MIDI mode that sends out MIDI commands instead of mouse movements‚Äîwhich has been inadvertantly assumed/requested by other folks throwing out
        their own cool ‚Äúwhat if you did ___‚Äù follow-up ideas. - I‚Äôd like to add an ‚Äú‚Äòeasier‚Äô mode‚Äù that locks slide movements to set pitch increments, so that note jumps are discrete rather than continuous. Trombone Champ, now with 100%
        more autotune!
      </p>
      <p>Do you have ideas? Do you know me irl and want to make some doots? Let me know!</p>
      <p>TODO-video: using the controller to scroll up and down a website</p>
      <p>
        <strong
          ><em>Thanks to MC and SS for playtesting, WT for putting up with us playtesting, and the good <a href="TODO">Trombone Champ folks</a> for their delightful game. TODO-link to repo</em></strong
        >
      </p>
      <section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
        <hr />
        <h3 id="footnotes-title">Footnotes</h3>
        <ol>
          <li id="fn1">
            <p>
              For the record, I am a flute/sax player and do not, nor have I ever, played a brass instrument. A disproportionate number of my friends do, though, from which I surmise that I am at heart a brass player‚Äîthough this is neither
              the time nor place to delve further into <em>that</em>! üòÖ<a href="#fnref1" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a>
            </p>
          </li>
          <li id="fn2">
            <p>
              ‚ÄúWireless‚Äù in the ‚Äúis not physically tethered to the computer running the game‚Äù sense of the word, to be clear; their are quite visibly physical wires involved!<a href="#fnref2" class="footnote-back" role="doc-backlink"
                >‚Ü©Ô∏é</a
              >
            </p>
          </li>
          <li id="fn3">
            <p>Bystanders, roommates, and pets may disagree.<a href="#fnref3" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p>
          </li>
          <li id="fn4">
            <p>TODO - insert video of spike jones or something<a href="#fnref4" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p>
          </li>
          <li id="fn5">
            <p>I have spent <em>so</em> much time perusing Adafruit tutorials this year, they truly hold a wealth of knowledge.<a href="#fnref5" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p>
          </li>
        </ol>
      </section>
      <hr />
      <ul>
        <li>Created: 2024-12-05</li>
        <li>Last updated: 2024-12-05</li>
        <li>Type: project-write-up</li>
        <li>Tags: TODO</li>
      </ul>
    </div>
  </body>
</html>
